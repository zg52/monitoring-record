(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b56cff3c"],{"09f7":function(t,e,a){},9406:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard-container"},[a("el-row",{staticClass:"dashboard-card-box",attrs:{gutter:30}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("div",{staticClass:"title"},[t._v("今日访问人数")]),a("div",{staticClass:"number"},[t._v(t._s(t.todayVisits))])])]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("div",{staticClass:"title"},[t._v("平均停留时长")]),a("div",{staticClass:"number"},[t._v(t._s(t.averageLengthOfStay)+"秒")])])]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("div",{staticClass:"title"},[t._v("当前人数")]),a("div",{staticClass:"number"},[t._v(t._s(t.currentNumber))])])])],1),a("div",{staticClass:"dashboard-select-box"},[a("el-select",{attrs:{placeholder:"请选择统计方式"},model:{value:t.typeValue,callback:function(e){t.typeValue=e},expression:"typeValue"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{change:t.timeChange},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}})],1),a("div",{staticClass:"dashboard-chart-box"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:24,sm:24,lg:14}},[a("div",{staticClass:"left-box"},[a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{xs:24,sm:24,lg:24}},[a("div",{staticClass:"chart-wrapper"},[a("bar-chart",{attrs:{height:t.visitsHeight,"bar-data":t.visitsRecord,"bar-title":t.visitsTitle,"bar-data-arr":t.visitsDataArr,"bar-hover-value":t.visitsHoverValue}})],1)])],1),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:32}},[a("el-col",{attrs:{xs:24,sm:24,lg:24}},[a("div",{staticClass:"chart-wrapper"},[a("line-chart",{attrs:{"chart-type":"1","chart-data":t.averageRecord,"chart-title":t.averageTitle,"chart-data-arr":t.averageDataArr,"chart-hover-value":t.averageHoverValue}})],1)])],1),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:32}},[a("el-col",{attrs:{xs:24,sm:24,lg:24}},[a("div",{staticClass:"chart-wrapper"},[a("line-chart",{attrs:{"chart-type":"2","chart-data":t.totalRecord,"chart-title":t.totalTitle,"chart-data-arr":t.totalDataArr,"chart-hover-value":t.totalHoverValue}})],1)])],1)],1)]),a("el-col",{staticStyle:{padding:"130px 0 100px 0"},attrs:{xs:24,sm:24,lg:10}},[a("div",{staticClass:"right-box"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{xs:24,sm:24,lg:24}},[a("div",{staticClass:"chart-wrapper"},[a("pie-chart",{attrs:{"pie-data":t.sexRecord,"pie-title":t.sexTitle,"pie-data-arr":t.sexDataArr}})],1)])],1),a("el-row",{staticStyle:{"margin-top":"100px"},attrs:{gutter:10}},[a("el-col",{attrs:{xs:24,sm:24,lg:24}},[a("div",{staticClass:"chart-wrapper"},[a("pie-chart",{attrs:{"pie-data":t.ageRecord,"pie-title":t.ageTitle,"pie-data-arr":t.ageDataArr}})],1)])],1)],1)])],1)],1)],1)},i=[],s=a("1da1"),n=a("5530"),o=(a("96cf"),a("2f62")),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.className,style:{height:t.height,width:t.width}})},c=[],h=a("313e"),u=a.n(h);a("53ca"),a("ac1f"),a("5319"),a("4d63"),a("25f0"),a("d3b7"),a("4d90"),a("1276"),a("159b");function d(t,e,a){var r,i,s,n,o,l=function l(){var c=+new Date-n;c<e&&c>0?r=setTimeout(l,e-c):(r=null,a||(o=t.apply(s,i),r||(s=i=null)))};return function(){for(var i=arguments.length,c=new Array(i),h=0;h<i;h++)c[h]=arguments[h];s=this,n=+new Date;var u=a&&!r;return r||(r=setTimeout(l,e)),u&&(o=t.apply(s,c),s=c=null),o}}var p={data:function(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted:function(){var t=this;this.$_resizeHandler=d((function(){t.chart&&t.chart.resize()}),100),this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},beforeDestroy:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},activated:function(){this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},deactivated:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},methods:{$_initResizeEvent:function(){window.addEventListener("resize",this.$_resizeHandler)},$_destroyResizeEvent:function(){window.removeEventListener("resize",this.$_resizeHandler)},$_sidebarResizeHandler:function(t){"width"===t.propertyName&&this.$_resizeHandler()},$_initSidebarResizeEvent:function(){this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},$_destroySidebarResizeEvent:function(){this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)}}},v=6e3,f={mixins:[p],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,required:!0},barData:{type:Array,required:!0},barTitle:{type:String,required:!0},barDataArr:{type:Array,required:!0},barHoverValue:{type:String,required:!0}},data:function(){return{chart:null}},watch:{barData:function(t){this.setOptions(t,this.barTitle,this.barDataArr,this.barHoverValue)}},mounted:function(){var t=this;this.$nextTick((function(){t.initChart()}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=u.a.init(this.$el),this.setOptions(this.barData,this.barTitle,this.barDataArr,this.barHoverValue)},setOptions:function(t,e,a,r){this.chart.setOption({title:{text:e,left:"center",top:0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:"10%",left:"2%",right:"2%",bottom:"5%",containLabel:!0},xAxis:[{type:"category",data:a,axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value",axisLabel:{formatter:"{value}人"},axisTick:{show:!1}}],series:[{name:r,type:"bar",stack:"vistors",barWidth:"60%",data:t,animationDuration:v,itemStyle:{normal:{color:"#6236ff",lineStyle:{color:"#6236ff",width:2}}}}]})}}},g=f,m=a("2877"),b=Object(m["a"])(g,l,c,!1,null,null,null),y=b.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.className,style:{height:t.height,width:t.width}})},D=[],w={mixins:[p],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"250px"},pieData:{type:Array,required:!0},pieTitle:{type:String,required:!0},pieDataArr:{type:Array,required:!0}},data:function(){return{chart:null}},watch:{pieData:{deep:!0,handler:function(t){this.initChart(t,this.pieTitle,this.pieDataArr)}}},mounted:function(){var t=this;this.$nextTick((function(){t.initChart(t.pieData,t.pieTitle,t.pieDataArr)}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(t,e,a){for(var r=0,i=0;i<=t.length-1;i++)0==t[i]["value"]&&r++;this.chart=u.a.init(this.$el),this.chart.setOption({title:{text:e,left:"center",top:0},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"right",bottom:"5",data:a},series:[{name:e,type:"pie",avoidLabelOverlap:!1,radius:["45%","70%"],data:r==t.length?[{value:0,name:"暂无数据"}]:t,center:["50%","50%"],animationEasing:"cubicInOut",animationDuration:2600,itemStyle:{borderRadius:20,color:r==t.length?"#ccc":"",borderColor:"#fff",borderWidth:5},emphasis:{label:{show:!0,fontSize:"30",fontWeight:"bold"}},label:{formatter:"{c}   {d}%"}}]})}}},R=w,S=Object(m["a"])(R,x,D,!1,null,null,null),_=S.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.className,style:{height:t.height,width:t.width}})},$=[],T={mixins:[p],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"250px"},autoResize:{type:Boolean,default:!0},chartData:{type:Array,required:!0},chartTitle:{type:String,required:!0},chartDataArr:{type:Array,required:!0},chartHoverValue:{type:String,required:!0},chartType:{type:String,required:!0}},data:function(){return{chart:null}},watch:{chartData:{deep:!0,handler:function(t){this.setOptions(t,this.chartTitle,this.chartDataArr,this.chartHoverValue)}}},mounted:function(){var t=this;this.$nextTick((function(){t.initChart()}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=u.a.init(this.$el),this.setOptions(this.chartData,this.chartTitle,this.chartDataArr,this.chartHoverValue)},setOptions:function(t,e,a,r){this.chart.setOption({title:{text:e,left:"center",top:0},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},grid:{top:"10%",left:"2%",right:"2%",bottom:"5%",containLabel:!0},xAxis:{type:"category",data:a,boundaryGap:!1,axisTick:{show:!1}},yAxis:[{type:"value",axisLabel:{formatter:"{value}s"},axisTick:{show:!1}}],series:[{name:r,itemStyle:{normal:{lineStyle:{color:"1"==this.chartType?"#24ccb8":"#ffc760",width:2}}},areaStyle:{color:"1"==this.chartType?"#24ccb817":"#ffc76017"},smooth:!0,type:"line",data:t,animationDuration:2800,animationEasing:"cubicInOut"}]})}}},C=T,E=Object(m["a"])(C,A,$,!1,null,null,null),O=E.exports,V=a("b775");function z(t){return Object(V["a"])({url:"/homeStatistics",method:"post",data:t})}function H(t){return Object(V["a"])({url:"/homeRefresh",method:"post",data:t})}var k={name:"Dashboard",data:function(){return{todayVisits:0,averageLengthOfStay:0,currentNumber:0,options:[{value:"0",label:"按小时统计"}],typeValue:"0",dateValue:(new Date).getTime(),visitsHeight:"250px",visitsRecord:[],visitsTitle:"访问人数",visitsDataArr:[],visitsHoverValue:"访问人数",averageRecord:[],averageTitle:"平均停留时长",averageDataArr:[],averageHoverValue:"平均留时长/S",totalRecord:[],totalTitle:"总停留时长",totalDataArr:[],totalHoverValue:"总停留时长/S",sexRecord:[],sexTitle:"性别分布",sexDataArr:[],ageRecord:[],ageTitle:"年龄分布",ageDataArr:[]}},components:{BarChart:y,PieChart:_,LineChart:O},computed:Object(n["a"])({},Object(o["b"])(["name"])),methods:{timeChange:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t){a.next=5;break}return console.log(t),e.dateValue=new Date(t).getTime(),a.next=5,e.fetchData();case 5:case"end":return a.stop()}}),a)})))()},clearData:function(){this.visitsRecord=[],this.visitsDataArr=[],this.averageRecord=[],this.averageDataArr=[],this.totalRecord=[],this.totalDataArr=[],this.sexRecord=[],this.sexDataArr=[],this.ageRecord=[],this.ageDataArr=[]},fetchData:function(){var t=this,e=this.typeValue,a=this.dateValue;this.clearData(),z({type:e,startTime:a,endTime:a}).then((function(e){var a=e.data,r=a.todayVisits,i=a.averageLengthOfStay,s=a.currentNumber,n=a.visitorsPerHour,o=a.averageLengthOfStayPerHour,l=a.theTotalStayTimePerHour,c=a.genderRatio,h=a.ageSegmentRatio;for(var u in t.todayVisits=r,t.averageLengthOfStay=i,t.currentNumber=s,n)t.visitsDataArr.push("".concat(u,"点")),t.visitsRecord.push(n[u]);for(var d in o)t.averageDataArr.push("".concat(d,"点")),t.averageRecord.push(o[d]);for(var p in l)t.totalDataArr.push("".concat(p,"点")),t.totalRecord.push(l[p]);for(var v in c){var f="";f="male"==v?"男":"female"==v?"女":"未知",t.sexDataArr.push(f),t.sexRecord.push({value:c[v],name:f})}for(var g in h)t.ageDataArr.push(g),t.ageRecord.push({value:h[g],name:g})})).catch((function(t){}))},fetchRefreshData:function(){var t=this;H().then((function(e){var a=e.data,r=a.todayVisits,i=a.averageLengthOfStay,s=a.currentNumber;t.todayVisits=r,t.averageLengthOfStay=i,t.currentNumber=s})).catch((function(t){}))}},created:function(){this.fetchData()},beforeDestroy:function(){this.$EventBus.$off("go")},mounted:function(){var t=this;this.$EventBus.$on("go",Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.fetchRefreshData();case 1:case"end":return e.stop()}}),e)}))))}},L=k,N=(a("a4d1"),Object(m["a"])(L,r,i,!1,null,"52f012d5",null));e["default"]=N.exports},a4d1:function(t,e,a){"use strict";a("09f7")}}]);